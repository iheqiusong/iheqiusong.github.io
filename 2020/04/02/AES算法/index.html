<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
  
  <title>C语言实现AES算法 | Hexo</title>
  <meta name="author" content="John Doe" />

  
  <meta name="description" content="c语言实现AES" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <meta property="og:title" content="C语言实现AES算法" />
  <meta property="og:site_name" content="Hexo" />

  
  

  
    <meta property="og:image" content="" />
  

  
  <link href="/css/images/favicon.ico" rel="icon" />
  

  <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  


  <!-- baidu webmaster push -->
  <script src='//push.zhanzhang.baidu.com/push.js'></script>

<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Hexo</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2020-04-02T06:37:44.000Z"><a href="/2020/04/02/AES算法/">2020-04-02</a></time>
      
      
  
    <h1 class="title">C语言实现AES算法</h1>
  

    </header>
    <div class="entry">
      
        <p>c语言实现AES</p>
<a id="more"></a>


<p>代码如下：</p>
<pre><code>#include&lt;stdio.h&gt;
#define N 4
static unsigned char Sbox[16*16]= 
{
// populate the Sbox matrix 
/* 0 1 2 3 4 5 6 7 8 9 a b c d e f */ 
/*0*/ 0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76, 
/*1*/ 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, 
/*2*/ 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, 
/*3*/ 0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, 
/*4*/ 0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84, 
/*5*/ 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf, 
/*6*/ 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, 
/*7*/ 0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, 
/*8*/ 0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73, 
/*9*/ 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb, 
/*a*/ 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, 
/*b*/ 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, 
/*c*/ 0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a, 
/*d*/ 0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e, 
/*e*/ 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, 
/*f*/ 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16
};
void SubBytes(unsigned char State[N][N])
{
int i,j;
char high;
char low;
for (i = 0; i &lt; N; i ++)
{
    for (j = 0; j &lt; N; j ++)
    {            
            low  = State[i][j] &amp; 0x0F;  //取低4位
            high = (State[i][j] &gt;&gt; 4)&amp;0x0f;  //取高4位
            State[i][j] = Sbox[16*high + low];
    }
}
}
void ShiftRows(unsigned char State[N][N])
{
int i,j,k;
int shiftnum = 0;
char tmp;

for (i = 0; i &lt; N; i ++)
{
    for (j = 0; j &lt; shiftnum; j ++)        //循环左移一次    
    { 
        tmp = State[i][0];
        for (k = 0; k &lt; N-1; k ++)
        {
            State[i][k] = State[i][k+1];
        }
        State[i][k] = tmp;
    }
    shiftnum ++;                       //移位次数+1
}
}
unsigned char gfmultby01(unsigned char b)
{
return b;
}
unsigned char gfmultby02(unsigned char b)
{
if (b &lt; 0x80)
    return (unsigned char)(int)(b &lt;&lt;1);
else
    return (unsigned char)( (int)(b &lt;&lt; 1) ^ (int)(0x1b) );
}
unsigned char gfmultby03(unsigned char b)
{
return (unsigned char) ( (int)gfmultby02(b) ^ (int)b );
}
unsigned char choose(unsigned char a, unsigned char b)
{
if (a == 0x01)
{
    return gfmultby01(b);
}
if (a == 0x02)
{
    return gfmultby02(b);
}
if (a == 0x03)
{
    return gfmultby03(b);
} 
return b;
}
void MixColumns(unsigned char State[N][N])  // 列混合
{
unsigned char mix[N][N] = 
{
    0x02, 0x03, 0x01, 0x01,
    0x01, 0x02, 0x03, 0x01,
    0x01, 0x01, 0x02, 0x03,
    0x03, 0x01, 0x01, 0x02
};
unsigned char tmp[N];
unsigned char end[N][N];
int i, j, k;
for (i = 0; i &lt; N; i++)
{
    for (j = 0; j &lt; N; j++)
    {
        for (k = 0; k &lt; N; k++)
        {
            tmp[k] = choose(mix[i][k], State[k][j]);
        }
        end[i][j] = tmp[0] ^ tmp[1] ^ tmp[2] ^ tmp[3];
    }
}
for (i = 0; i &lt; N; i++)
{
    for (j = 0; j &lt; N; j++)
    {
        State[i][j] = end[i][j];
    }
}
}
void AddRoundKey(unsigned char State[N][N], unsigned char RoundKey[N][N])
{
int i,j;
for (j = 0; j &lt; N; j ++)
{
    for (i = 0; i &lt; N; i ++)
        State[i][j] = State[i][j] ^ RoundKey[i][j];
}
}
void main()
{
unsigned char input[32];        //输入
unsigned char state[4][4];
unsigned char key[32];
unsigned char RoundKey[4][4];

//测试数据        49 15 59 8f 55 e5 d7 a0 da ca 94 fa 1f 0a 63 f7
//                b6 ff 74 4e d2 c2 c9 bf 6c 59 0c bf 04 69 bf 41

int i;
printf(&quot;请输入明文:&quot;);
for(i = 0; i &lt; 16; i++)
{
    scanf(&quot;%x&quot;,&amp;input[i]);
}
printf(&quot;请输入轮加密的子秘钥:&quot;);
for(i = 0; i &lt; 16; i++)
{
    scanf(&quot;%x&quot;,&amp;key[i]);
}
for(i = 0;i &lt; 4;i++)
{
    for(int j = 0;j &lt; 4;j++)
    {
        RoundKey[j][i] =key[i*4+j];
    }
}


printf(&quot;round[3].start     &quot;);
for(i = 0; i &lt; 16; i++)
{
    printf(&quot;%02x&quot;,input[i]);
}
printf(&quot;\n&quot;);
for(i = 0;i &lt; 4;i++)
{
    for(int j = 0;j &lt; 4;j++)
    {
        state[j][i] =input[i*4+j];
    }
}

//s盒
printf(&quot;round[3].s_box     &quot;);
SubBytes(state);
for(i=0;i&lt;4;i++)
{
    for(int j =0;j&lt;4;j++)
    {
        printf(&quot;%02x&quot;,state[j][i]);
    }
}
printf(&quot;\n&quot;);

//行移位
ShiftRows(state);
printf(&quot;round[3].row       &quot;);
for(i=0;i&lt;4;i++)
{
    for(int j =0;j&lt;4;j++)
    {
        printf(&quot;%02x&quot;,state[j][i]);
    }
}
printf(&quot;\n&quot;);

//列混合
printf(&quot;round[3].m_col     &quot;);
MixColumns(state);
for(i=0;i&lt;4;i++)
{
    for(int j =0;j&lt;4;j++)
    {
        printf(&quot;%02x&quot;,state[j][i]);
    }
}
printf(&quot;\n&quot;);

//轮秘钥加
printf(&quot;round[3].k_sch     &quot;);
for(i=0;i&lt;4;i++)
{
    for(int j =0;j&lt;4;j++)
    {
        printf(&quot;%02x&quot;,RoundKey[j][i]);
    }
}
printf(&quot;\n&quot;);

printf(&quot;round[3].out       &quot;);
AddRoundKey(state,RoundKey);
for(i=0;i&lt;4;i++)
{
    for(int j =0;j&lt;4;j++)
    {
        printf(&quot;%02x&quot;,state[j][i]);
    }
}
printf(&quot;\n&quot;);
}</code></pre><p>运行结果截图：</p>
<p><img src="1.png" alt="alt"></p>

      
    </div>
    
    <footer>
        <div class="alignright">
          
          <a href='javascript:void(0)' class="share-link bdsharebuttonbox" data-cmd="more">分享</a>
        </div>
        
        
        <!-- partial('post/share') -->
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/2020/07/13/花指令/">花指令</a>
      </li>
    
      <li>
        <a href="/2020/05/21/使用C语言和易语言写一个简单的内存补丁/">使用C语言和易语言写一个简单的内存补丁</a>
      </li>
    
      <li>
        <a href="/2020/05/21/如何写一个ida和ollydbg搜索不到字符串的程序/">ida和ollydbg搜索不到字符串</a>
      </li>
    
      <li>
        <a href="/2020/04/07/破解软件注册码的一般思路/">破解软件注册码的一般思路</a>
      </li>
    
      <li>
        <a href="/2020/04/02/AES算法/">C语言实现AES算法</a>
      </li>
    
  </ul>
</div>


  

  
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  <p>
  
  &copy; 2020 John Doe
  
  All rights reserved.</p>
  <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></p>
</div>
<div class="clearfix"></div>

<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<div id='bg'></div>
</body>
</html>